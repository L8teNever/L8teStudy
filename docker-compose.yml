services:
  l8testudy:
    image: l8tenever/l8testudy:latest
    container_name: l8testudy
    ports:
      - 10.66.66.1:5000:5000
    volumes:
      - ./data:/data
    env_file:
      - .env
    environment:
      DATABASE_URL: sqlite:////data/l8testudy.db
      FLASK_ENV: production
      # Google Drive OAuth Integration (referencing variables from .env)
      GOOGLE_CLIENT_ID: ${GOOGLE_CLIENT_ID}
      GOOGLE_CLIENT_SECRET: ${GOOGLE_CLIENT_SECRET}
      DRIVE_ENCRYPTION_KEY: ${DRIVE_ENCRYPTION_KEY}
      GOOGLE_REFRESH_TOKEN: ${GOOGLE_REFRESH_TOKEN}
      GOOGLE_SERVICE_ACCOUNT_INFO: ${GOOGLE_SERVICE_ACCOUNT_INFO}
      SECRET_KEY: ${SECRET_KEY}
      # Upload
      UPLOAD_FOLDER: /data/uploads
      MAX_CONTENT_LENGTH: 104857600
      TZ: Europe/Berlin
      # Gunicorn Timeout Fix (for slow DB migrations)
      GUNICORN_CMD_ARGS: "--timeout 120 --workers 2"
    restart: always

networks: {}
