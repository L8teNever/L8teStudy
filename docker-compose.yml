services:
  web:
    build: .
    ports:
      - "5000:5000"
    volumes:
      - ./instance:/data
    environment:
      - DATABASE_URL=sqlite:////data/l8testudy.db
      - SECRET_KEY=${SECRET_KEY:-your-secret-key-here}
      - FLASK_ENV=production
      
      # WebUntis Integration
      - UNTIS_FERNET_KEY=${UNTIS_FERNET_KEY:-your-untis-fernet-key-here}
      
      # Google Drive Integration
      - GOOGLE_SERVICE_ACCOUNT_FILE=/data/service-account.json
      - DRIVE_ENCRYPTION_KEY=${DRIVE_ENCRYPTION_KEY:-qv6aHbyp1j1xHpLVE87DIax+x/4YvD54rlh3SbZGTjg=}
      - ENCRYPTED_FILES_PATH=/data/encrypted_files
      
      # Upload Configuration
      - UPLOAD_FOLDER=/data/uploads
      - MAX_CONTENT_LENGTH=104857600
      
      # Security
      - SESSION_COOKIE_SECURE=True
      - SESSION_COOKIE_HTTPONLY=True
      - SESSION_COOKIE_SAMESITE=Lax
      - TZ=Europe/Berlin
    restart: always
